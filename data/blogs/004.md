---
title: お手軽Emoji Prefix (CLI向け)
author: loxygen
date: '2021-01-22'
---

フライさんです。連投して3つ目です。今回はGitのお話です。<br />
**普段CLIで作業している変態向け**記事です。**[JetBrains製エディタユーザの方はこちらをご覧ください](/blog/005)** :pray:

[本編はここから](#emoji-prefix-with-tool)始まります。

# :slightly_smiling_face: Emoji Prefix

Emoji prefixというのは **コミットメッセージ** の形式の一つです。

Emoji prefixでない形式であれば…

```
feat: create extremely cool stuff
```

というような書き方が主流です。他にも

```
fix(READMDE.md): fix typo in the example
```

とかやったりします。

では、Emoji prefixがどうかというと…

```
✨ create extremely cool stuff
```
```
✏️(README.md) fix typo in the example
```

**やだ、かんわいい**。あと**わかりやすい**。

他の形式で `feat` や `fix` など、いわゆる **"Prefix"に英単語を用いる**のに対して、Emoji prefixでは :sparkles: や :pencil2:、:bug:などの **絵文字を使用します**。かわいすぎ。

## :thinking: めんどくさそう？

**そんなことないです**。もちろん、自分で絵文字ピッカーから絵文字を選択してやる場合はメリットよりも手間のほうが大きくなってしまいますが、 **Emoji Prefixに大変便利なツールが作成されています**。後々ご紹介します。

とにかく伝えたいのは、 **簡単にEmoji Prefixできるツールがあるので全くめんどくさくない**ということです。

## :thumbsup: いい

**Emoji Prefixいいんですよ**。具体的に何がいいかというと…

### :revolving_hearts: かわいい

かわいい。

### :eyes: わかりやすい

Emoji prefixにはルールが存在していて、それに沿ったコミットをすることで、**ひと目で変更の概略をつかめるようになります**。加えて、

ルールの一例をご紹介します:

| やったこと                  | 英単語で書くPrefix | Emoji Prefix      |
| --------------------------- | ------------------ | ----------------- |
| 機能追加                    | `feat`             | :sparkles:        |
| ファイル/コード削除         | `remove`           | :fire:            |
| ファイル/コード移動         | `move`             | :truck:           |
| 依存関係追加                | `dep` / `add`      | :heavy_plus_sign: |
| 外部APIの仕様変更による修正 | `fix`              | :alien:           |
| 勢いに任せてコードを書いた  | ???                | :beer:            |

などなど。**めちゃんこあります**。めちゃんこありますが、**絵文字というビジュアルに訴える文字を採用している**おかげでパット見で何やったかわかりますね。:fire:とか絶対なんか燃やしてますし、:truck:とか絶対物を動かしています。

:beer:は多分酔った勢いでコードを書いたんだと思います。**限界開発**を感じますね。

### :rainbow: 映える

**映えます**。絵文字はカラフルなので。

<a id="emoji-prefix-with-tool" />

# :sparkles: ツールを使ってEmoji Prefixする (CLI向け)

先述したように、一見してみると**マジでめんどくさそう**ですが、大丈夫です。
**簡単にEmoji Prefixできるツールが提供されています**。「[gitmoji-cli](https://github.com/carloscuesta/gitmoji-cli)」です。

gitmoji-cliを使用すると、**以下の3ステップを踏むだけでEmoji prefixできるようになります**。

1. 絵文字を選択する。(キーワードから絞り込み可能)
2. コミットメッセージのタイトルを入力する。
3. コミットメッセージの本文を入力する。(省略可能)

絵文字選択機能があるのは大きいですね。検索もできるので、**自分で絵文字を探してコミットメッセージに貼り付けるという作業が不要になります**。


## :arrow_double_down: インストール

`yarn` (か`npm`) を使用するので、nodeが入ってなかったりする場合は`nvm`とかを使用して導入しておいてください。

```bash
yarn global add gitmoji-cli
# npm -g install gitmoji-cli
```

これでgitmoji-cliが入りました。

## :building_construction: 初期設定

### インストールした後

```bash
gitmoji -u
```

使用する前に、このコマンドでインターネットからEmoji prefixのルールを読み込みます。

### リポジトリごとに

これはやんなくても大丈夫ですが、やったほうが楽だと思います。

```bash
$ gitmoji -i
✔ Gitmoji commit hook created successfully
```

これをすると、リポジトリにフックが生成され、**`git commit` コマンドを実行すると`gitmoji`によるコミットメッセージの生成ウィザードが走るようになります。**

フックを使用しない場合は `gitmoji -c` でコミットできます。

## :pencil2: 使ってみる

### :slightly_smiling_face: 絵文字を選ぶ

上にも示した3ステップで簡単にEmoji prefixできます。

```bash
cd /path/to/some/random/repository
gitmoji -i
# 何か変更を加える
git add .
git commit
```

ここまで行くと、通常ではVimかなんかが出てきてコミットメッセージを要求されますが、Gitmojiのフックが有効になっている場合は…

```
? Choose a gitmoji: (Use arrow keys or type to search)
❯ 🎨  - Improve structure / format of the code.
  ⚡️  - Improve performance.
  🔥  - Remove code or files.
  🐛  - Fix a bug.
  🚑  - Critical hotfix.
  ✨  - Introduce new features.
  📝  - Add or update documentation.
(Move up and down to reveal more choices)
```

こんな感じの絵文字選択プロンプトが出てきます。*briliant*。
この画面で上下キーを使用して絵文字を選択します。

また、量が多いので…

```
? Choose a gitmoji: fix
❯ ✏️  - Fix typos.
  🐛  - Fix a bug.
  🔒  - Fix security issues.
  💚  - Fix CI Build.
  🚨  - Fix compiler / linter warnings.
  🚑  - Critical hotfix.
  🩹  - Simple fix for a non-critical issue.
(Move up and down to reveal more choices)
```

こんな感じでキーワード絞り込みすることもできます。
大体は、 **キーワード絞り込み** → **絵文字選択** というフローで絵文字を選びます。

絵文字を選択したあと、Enterキーを押します。
```
? Choose a gitmoji: ✨  - Introduce new features.
? Enter the commit title [0/48]: 
```

コメントを入力する画面に入るので、コメントを打ちます。

```
? Choose a gitmoji: ✨  - Introduce new features.
? Enter the commit title [24/48]: Added searching function
? Enter the commit message: (# with '#' will be ignored, and an empty message ab
orts the commit.)
```

コミットメッセージの詳細を入力する画面です。
「空のメッセージが入力されるとコミットを中断するぜ！」という旨のことが書いてありますが、打たなくても大丈夫です。

![Vim-after-the-commit-message-has-been-confirmed](https://i.imgur.com/uDh3ro7.png)

Enterを押すといつものコミットメッセージ入力画面に**Emoji prefixされたコミットメッセージ**が入力されている画面になります。
この画面で保存&終了すると、コミットされます。

```
? Choose a gitmoji: ✨  - Introduce new features.
? Enter the commit title [24/48]: Added searching function
? Enter the commit message: # with '#' will be ignored, and an empty message abo
rts the commit.
[master f1f628d] ✨ Added searching function
 1 file changed, 1 insertion(+)
 create mode 100644 search.cpp.c
```

いいですね。最高です。

## :dizzy: その他の便利 stuff
### :wrench: 設定をいじる

```
gitmoji -g
```

以下の項目が設定できます。

- **自動 `git add`**
- **絵文字のUnicode化**
- **GPG(PGP)を用いたSignedコミットの強制**
- **スコープ追加**

Unicode化を有効にすると、「`:hogehoge:`」というテキストの形式ではなく「:face_with_hand_over_mouth:」の形式でコミットされるようになります。すなわち絵文字に対応している環境でコミットメッセージがよりエモく表示されるようになります。

### :eyes: 絵文字を探す
Gitmojiのルールに登録されている絵文字を検索することができます。プルリクエストのタイトルにもEmoji Prefixしたいときなどに便利です。

```
$ gitmoji -s dependency
➕ - :heavy_plus_sign: - Add a dependency.
➖ - :heavy_minus_sign: - Remove a dependency.
⬆️ - :arrow_up: - Upgrade dependencies.
📌 - :pushpin: - Pin dependencies to specific versions.
⬇️ - :arrow_down: - Downgrade dependencies.
🗑 - :wastebasket: - Deprecate code that needs to be cleaned up.
```

dependencyだけでもいっぱいありますね。すげえ。

### :floppy_disk: フックを介さずにコミットする
フックを登録しないでコミットすることもできます。
```
gitmoji -c
```
このコマンドを実行すると、上に記したコミットのウィザードが実行でいます。ただし、ウィザードが完了したあと **コミットメッセージの編集画面を介さずにコミットされる** ので注意です。[^1]

# :wave: まとめ

- Emoji Prefixはかわいくて映える
- gitmoji-cliすればめんどくさくない
- `gitmoji -i` → うんたらかんたら → `git commit`

---

## :bookmark: 注釈

[^1]: 加えて、`git add`し忘れたまま`gitmoji -ci`すると、コミットメッセージの確定時に例外を吐いて堕ちます。フック張っておくのが確実?

